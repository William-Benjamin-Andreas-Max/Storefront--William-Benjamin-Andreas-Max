<!DOCTYPE html>
<html lang="da">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>INFINITE FINDS</title>
    <link rel="stylesheet" href="assets/Styles/css/main.css" />
    <script src="assets/JS/main.js" defer></script>
    <meta name="theme-color" content="#000" />
  </head>

  <body>
    <div id="app"></div>
  </body>
</html>



// create modal
function getModel() {
  let myHtml = `<div id="modal" class="modal hidden" onclick="toggleModal()">    
  <aside onclick="event.stopPropagation()" >
  <div">    
  <aside>
      <div class="modelClose">
        <span><img onclick="toggleModal()" src="assets/Images/X.svg" alt="close" /></span>
      </div>
      <section class="yourCart">
        <h3>Your Cart</h3>
        <section class="cartItemsContainer">
        <ul id="cart-items">
        </ul>
        </section>
      </section>
      <footer>
        <hgroup>
          <h4 id="basketCartTotal">Subtotal (${basketTotalAmount})</h4>
          <h4 id="basketCartTotalPrice">$${basketTotalPrice}</h4>
        </hgroup>
        <button>CONTINUE TO CHECKOUT</button>
        <p>Psst, get it now before it sells out.</p>
      </footer>
    </aside></div>`;
  productsContainer.innerHTML += myHtml;
}

// toggle modal
function toggleModal() {
  const modal = document.getElementById("modal");
  modal.classList.toggle("hidden");
}
//#endregion
//#region display cart items and remove when product under 1
function displayCartItems() {
  let cartItemsContainer = document.getElementById("cart-items");
  if (cartItemsContainer) {
    cartItemsContainer.innerHTML = "";

    if (basketData.length === 0) {
      cartItemsContainer.innerHTML = "<p>Your cart is empty.</p>";
      return;
    }

    // Loop through each item in the basketData
    basketData.forEach((item) => {
      fetch(`https://dummyjson.com/products/${item.id}`)
        .then((response) => {
          if (!response.ok) throw new Error(`Error: ${response.status}`);
          return response.json();
        })
        .then((product) => {
          // console.log(product);

          let productHTML = `
            <li class="cart-item" id="item-${item.id}">
              <img src="${product.thumbnail}" alt="${product.title}" class="cart-item-image" />
              <div class="item-details">
              <div class="titlePrice">
                <p>${product.title}</p>
                <p class="">$${product.price}</p> 
                </div>
                <section>
                  <span class="remove-product" data-id="${item.id}">
                    <img class="trash" src="assets/Images/Trash.svg" alt="Trash" />
                  </span>
                  <div class="plus-minusAmount">
                    <button onclick="decreaseAmount(${item.id})">
                      <img src="assets/Images/Minus.svg" alt="Minus" />
                    </button>
                    <p id="amount-${item.id}">${item.amount}</p>
                    <button onclick="increaseAmount(${item.id})">
                      <img src="assets/Images/Plus.svg" alt="Plus" />
                    </button>
                  </div>
                </section>
              </div>
            </li>
                          <hr>
          `;
          cartItemsContainer.innerHTML += productHTML;

          // Add event listener to the newly created remove button
          const removeButton = cartItemsContainer.querySelector(
            `.remove-product[data-id="${item.id}"]`
          );
          removeButton.addEventListener("click", () => removeItem(item.id));
        })
        .catch((error) => {
          console.error(error);
          cartItemsContainer.innerHTML += `<p>Error fetching product details for ID: ${item.id}</p>`;
        });
    });
  }
}
//#endregion
//#region Increase, Decrease products + -
function increaseAmount(id) {
  const product = basketData.find((basketItem) => basketItem.id === id);
  if (product) {
    product.amount += 1;
    updateDisplay(id);
    getBasketTotal();
  }
}

function decreaseAmount(id) {
  const product = basketData.find((basketItem) => basketItem.id === id);

  if (product && product.amount > 0) {
    product.amount -= 1;
    updateDisplay(id);
    getBasketTotal();
  }
  if (product.amount < 1) {
    removeItem(id);
  }
}
function updateDisplay(id) {
  const amountElement = document.getElementById(`amount-${id}`);
  const product = basketData.find((basketItem) => basketItem.id === id);
  if (amountElement && product) {
    amountElement.textContent = product.amount;
  }
  saveData();
}

function removeItem(id) {
  const index = basketData.findIndex((item) => item.id === id);
  console.log(index);
  basketData.splice(index, 1);
  saveData();
  getBasketTotal();
  displayCartItems();
}

// Callback
getModel();

//#endregion

// comit

// comit 

// comit

// comit

// comit

// comit